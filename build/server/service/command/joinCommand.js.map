{"version":3,"sources":["../../../../server/service/command/joinCommand.js"],"names":["user","data","world","out","status","send","toAll","connected","userList","push","game","flipped","type","spawn","key","actions","onMove","creature","objects","antena1Fields","antena2Fields","antena1","antena2","ready"],"mappings":";;;;;;AAAA;;;;;;kBAEe,UAACA,IAAD,EAAOC,IAAP,EAAaC,KAAb,EAAuB;;AAElC,QAAIC,MAAM;AACNC,gBAAQ;AACJC,kBAAM,KADF;AAEJC,mBAAO;AAFH,SADF;AAKNJ,eAAOA;AALD,KAAV;;AAQA,QAAIC,IAAID,KAAJ,CAAUK,SAAV,IAAuB,CAA3B,EAA8B;AAC1BJ,YAAID,KAAJ,CAAUK,SAAV,IAAuB,CAAvB;AACAJ,YAAID,KAAJ,CAAUM,QAAV,CAAmBC,IAAnB,CAAwBT,IAAxB;AACAG,YAAID,KAAJ,CAAUF,IAAV,CAAeA,IAAf,IAAuB;AACnBC,kBAAMA,IADa;AAEnBS,kBAAM;AACFC,yBAAS,sBAAYR,IAAID,KAAJ,CAAUU,IAAtB,EAA4BC,KAA5B,CAAkCV,IAAID,KAAJ,CAAUK,SAAV,GAAsB,CAAxD,EAA2DI,OADlE;AAEFE,uBAAO,sBAAYV,IAAID,KAAJ,CAAUU,IAAtB,EAA4BC,KAA5B,CAAkCV,IAAID,KAAJ,CAAUK,SAAV,GAAsB,CAAxD,EAA2DO;AAFhE,aAFa;AAMnBC,qBAAS;AANU,SAAvB;;AASA,YAAIZ,IAAID,KAAJ,CAAUK,SAAV,KAAwB,CAA5B,EAA+B;AAC3BJ,gBAAID,KAAJ,CAAUc,MAAV,GAAmB,CAAnB;AACH;;AAED,YAAIb,IAAID,KAAJ,CAAUK,SAAV,KAAwB,CAA5B,EAA+B;AAC3BJ,gBAAID,KAAJ,CAAUF,IAAV,CAAeG,IAAID,KAAJ,CAAUM,QAAV,CAAmB,CAAnB,CAAf,EAAsCO,OAAtC,CAA8CN,IAA9C,CAAmD;AAC/CG,sBAAM,WADyC;AAE/CX,sBAAME,IAAID,KAAJ,CAAUF,IAAV,CAAeG,IAAID,KAAJ,CAAUM,QAAV,CAAmB,CAAnB,CAAf,EAAsCP,IAAtC,CAA2CgB;AAFF,aAAnD;AAIAd,gBAAID,KAAJ,CAAUF,IAAV,CAAeG,IAAID,KAAJ,CAAUM,QAAV,CAAmB,CAAnB,CAAf,EAAsCO,OAAtC,CAA8CN,IAA9C,CAAmD;AAC/CG,sBAAM,WADyC;AAE/CX,sBAAME,IAAID,KAAJ,CAAUF,IAAV,CAAeG,IAAID,KAAJ,CAAUM,QAAV,CAAmB,CAAnB,CAAf,EAAsCP,IAAtC,CAA2CgB;AAFF,aAAnD;;AAKAd,gBAAID,KAAJ,CAAUgB,OAAV,GAAoB,sBAAYf,IAAID,KAAJ,CAAUU,IAAtB,EAA4BM,OAAhD;AACAf,gBAAID,KAAJ,CAAUiB,aAAV,GAA0B,sBAAYhB,IAAID,KAAJ,CAAUU,IAAtB,EAA4BO,aAAtD;AACAhB,gBAAID,KAAJ,CAAUkB,aAAV,GAA0B,sBAAYjB,IAAID,KAAJ,CAAUU,IAAtB,EAA4BQ,aAAtD;AACAjB,gBAAID,KAAJ,CAAUmB,OAAV,GAAoB,sBAAYlB,IAAID,KAAJ,CAAUU,IAAtB,EAA4BS,OAAhD;AACAlB,gBAAID,KAAJ,CAAUoB,OAAV,GAAoB,sBAAYnB,IAAID,KAAJ,CAAUU,IAAtB,EAA4BU,OAAhD;;AAEAnB,gBAAID,KAAJ,CAAUqB,KAAV,GAAkB,IAAlB;AACApB,gBAAIC,MAAJ,CAAWC,IAAX,GAAkB,IAAlB;AACH;AACJ;;AAED,WAAOF,GAAP;AACH,C","file":"joinCommand.js","sourcesContent":["import worldConfig from '../../config/worldConfig';\n\nexport default (user, data, world) => {\n    \n    let out = {\n        status: {\n            send: false,\n            toAll: true\n        },\n        world: world\n    }\n    \n    if (out.world.connected != 2) {\n        out.world.connected += 1;\n        out.world.userList.push(user);\n        out.world.user[user] = {\n            data: data,\n            game: {\n                flipped: worldConfig[out.world.type].spawn[out.world.connected - 1].flipped,\n                spawn: worldConfig[out.world.type].spawn[out.world.connected - 1].key\n            },\n            actions: []\n        };\n        \n        if (out.world.connected === 1) {\n            out.world.onMove = 0;\n        }\n\n        if (out.world.connected === 2) {\n            out.world.user[out.world.userList[0]].actions.push({\n                type: 'startGame',\n                data: out.world.user[out.world.userList[1]].data.creature\n            });\n            out.world.user[out.world.userList[1]].actions.push({\n                type: 'startGame',\n                data: out.world.user[out.world.userList[0]].data.creature\n            });\n\n            out.world.objects = worldConfig[out.world.type].objects;\n            out.world.antena1Fields = worldConfig[out.world.type].antena1Fields;\n            out.world.antena2Fields = worldConfig[out.world.type].antena2Fields;\n            out.world.antena1 = worldConfig[out.world.type].antena1;\n            out.world.antena2 = worldConfig[out.world.type].antena2;\n\n            out.world.ready = true;\n            out.status.send = true;\n        }\n    }\n\n    return out;\n};"]}