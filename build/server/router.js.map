{"version":3,"sources":["../../server/router.js"],"names":["Router","logger","getInstance","expressRouter","app","disable","use","json","urlencoded","extended","init","run","static","process","env","WEBAPP_STATIC","WEBAPP_ASSETS","info","PORT","listen","route","dir","options","join","__dirname"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;IAEMA,M;AAKF,sBAAc;AAAA;;AAAA,aAHdC,MAGc,GAHL,iBAAOC,WAAP,EAGK;AAAA,aAFdC,aAEc,GAFE,yBAAG,wBAAH,CAEF;;AACV,aAAKA,aAAL,CAAmBC,GAAnB,CAAuBC,OAAvB,CAA+B,cAA/B;AACA,aAAKF,aAAL,CAAmBC,GAAnB,CAAuBE,GAAvB,CAA2B,qBAA3B;AACA,aAAKH,aAAL,CAAmBC,GAAnB,CAAuBE,GAAvB,CAA2B,qBAAWC,IAAX,EAA3B;AACA,aAAKJ,aAAL,CAAmBC,GAAnB,CAAuBE,GAAvB,CAA2B,qBAAWE,UAAX,CAAsB,EAAEC,UAAU,IAAZ,EAAtB,CAA3B;AACA,aAAKC,IAAL;AACA,aAAKC,GAAL;AACH;;;;+BAEM;AACH,iBAAKC,MAAL,CAAY,SAAZ,EAAuBC,QAAQC,GAAR,CAAYC,aAAnC;AACA,iBAAKH,MAAL,CAAY,SAAZ,EAAuBC,QAAQC,GAAR,CAAYE,aAAnC;AACA,uCAAiB,KAAKb,aAAtB,EAAqC,qBAArC;AACA,+CAAyB,KAAKA,aAA9B,EAA6C,8BAA7C;AACA,uCAAiB,KAAKA,aAAtB,EAAqC,WAArC;AACA,wCAAkB,KAAKA,aAAvB,EAAsC,qBAAtC;AACA,uCAAiB,KAAKA,aAAtB,EAAqC,IAArC;AACH;;;8BAEK;AACF,iBAAKF,MAAL,CAAYgB,IAAZ,CAAiB,uBAAjB,EAA0CJ,QAAQC,GAAR,CAAYI,IAAtD;AACA,iBAAKf,aAAL,CAAmBC,GAAnB,CAAuBe,MAAvB,CAA8BN,QAAQC,GAAR,CAAYI,IAA1C;AACH;;;gCAEME,K,EAAOC,G,EAAmB;AAAA,gBAAdC,OAAc,uEAAJ,EAAI;;AAC7B,iBAAKnB,aAAL,CAAmBC,GAAnB,CAAuBE,GAAvB,CAA2Bc,KAA3B,EAAkC,kBAAQR,MAAR,CAAe,eAAKW,IAAL,CAAUC,SAAV,EAAqBH,GAArB,CAAf,EAA0CC,OAA1C,CAAlC;AACH;;;;;;kBAIUtB,M","file":"router.js","sourcesContent":["import express from 'express';\nimport ws from 'express-ws';\nimport cors from 'cors';\nimport bodyParser from 'body-parser';\nimport path from 'path';\n\nimport Logger from './helper/logger';\nimport RootEndpoint from './endpoint/app/rootEndpoint';\n\nimport UserEndpoint from './endpoint/api/userEndpoint';\nimport UserCreatureEndpoint from './endpoint/api/userCreatureEndpoint';\nimport JoinEndpoint from './endpoint/api/joinEndpoint';\nimport WorldEndpoint from './endpoint/api/worldEndpoint';\n\nclass Router {\n    \n    logger = Logger.getInstance();\n    expressRouter = ws(express());\n    \n    constructor() {\n        this.expressRouter.app.disable('x-powered-by');\n        this.expressRouter.app.use(cors());\n        this.expressRouter.app.use(bodyParser.json());\n        this.expressRouter.app.use(bodyParser.urlencoded({ extended: true }));\n        this.init();\n        this.run();\n    }\n\n    init() {\n        this.static('/static', process.env.WEBAPP_STATIC);\n        this.static('/assets', process.env.WEBAPP_ASSETS);\n        new UserEndpoint(this.expressRouter, '/api/user/:nickname');\n        new UserCreatureEndpoint(this.expressRouter, '/api/user/:nickname/creature');\n        new JoinEndpoint(this.expressRouter, '/api/join');\n        new WorldEndpoint(this.expressRouter, '/api/world/:worldId');\n        new RootEndpoint(this.expressRouter, '/*');\n    }\n\n    run() {\n        this.logger.info('Server listen on port', process.env.PORT);\n        this.expressRouter.app.listen(process.env.PORT);    \n    }\n\n    static(route, dir, options = {}) {\n        this.expressRouter.app.use(route, express.static(path.join(__dirname, dir), options));\n    }\n\n}\n\nexport default Router;"]}